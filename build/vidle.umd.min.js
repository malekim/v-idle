!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("vue-demi")):"function"==typeof define&&define.amd?define(["vue-demi"],n):(e="undefined"!=typeof globalThis?globalThis:e||self)["v-idle"]=n(e.VueDemi)}(this,(function(e){"use strict";return e.defineComponent({emits:["idle","remind","refresh"],props:{duration:{type:Number,default:300},events:{type:Array,default:function(){return["mousemove","keypress"]}},loop:{type:Boolean,default:!1},syncKey:{type:String,default:""},reminders:{type:Array,default:function(){return[]}},wait:{type:Number,default:0}},setup:function(n,t){var a=t.emit,o=e.ref(""),u=e.ref(void 0),r=e.ref(0),i=e.ref(void 0),l=e.ref(0),v=e.ref(""),d=e.ref(""),f=e.ref(void 0),s=n.syncKey.length>0&&"undefined"!=typeof window&&"BroadcastChannel"in window,c=function(){if(l.value=n.duration-((Date.now()-r.value)/1e3|0),l.value<0&&!n.loop)return clearInterval(u.value),void clearInterval(i.value);n.reminders.length>0&&n.reminders.includes(l.value)&&m();var e=l.value/60|0,t=l.value%60|0;v.value="".concat(e<10?"0"+e:e),d.value="".concat(t<10?"0"+t:t),o.value="".concat(v.value,":").concat(d.value)},y=function(){c(),l.value<=0&&n.loop&&(r.value=Date.now()+1e3)},p=function(){a("idle")},m=function(){a("remind")},w=function(){u.value=window.setInterval(p,1e3*n.duration),i.value=window.setInterval(y,1e3)},h=function(e){var n={type:e.type,key:e instanceof KeyboardEvent?e.key:void 0};g(n),s&&I(n)},g=function(e){a("refresh",e),clearInterval(u.value),clearInterval(i.value),c(),r.value=Date.now(),l.value=0,w()},I=function(e){void 0!==f.value&&f.value.postMessage(e)};return e.onMounted((function(){s&&(f.value=new BroadcastChannel(n.syncKey),f.value.addEventListener("message",(function(e){g(e.data)}))),setTimeout((function(){r.value=Date.now(),c(),e.nextTick((function(){w();for(var e=n.events.length-1;e>=0;e-=1)window.addEventListener(n.events[e],h)}))}),1e3*n.wait)})),e.onBeforeUnmount((function(){clearInterval(u.value),clearInterval(i.value);for(var e=n.events.length-1;e>=0;e-=1)window.removeEventListener(n.events[e],h)})),{display:o}},render:function(){return e.h("div",{class:"v-idle"},this.display)}})}));
//# sourceMappingURL=vidle.umd.min.js.map
